<!DOCTYPE html>
<html>
<head>
    <title>Monthly Precipitation Streamflow Example</title>
    <!-- Javascript -->

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="http://code.highcharts.com/highcharts.js"></script>
  <script src="http://code.highcharts.com/modules/heatmap.js"></script>
  <script src="http://code.highcharts.com/modules/exporting.js"></script>
</head>

<body>
<div id="container" style="width:100%; height:400px;"></div>
<script>
$.get("mock-data.csv",function(data) {

  var years = new Array();

  var lines = data.split('\n'),
      series = {
        turboThreshold: 0,
        data: [],
        borderWidth: 0,
      };
    
    // Iterate over the lines and add categories or series
    $.each(lines, function(lineNo, line) {
        
            if (lineNo > 0) 
            {
              var items = line.split(',');

              if(years.length == 0)
              {
                years.push(items[1]);
              }
              else
              {
                if(!years.includes(items[1]))
                {
                  years.push(items[1]);
                }
              }              
            }   
    });
    
    $.each(lines, function(lineNo, line) {
      if(lineNo > 0)
      {
        for(var index = 0; index < years.length; index++)
        {
          var items = line.split(',');
              
          if(items[1] == years[index])
          {
              series.data.push([parseFloat(items[0]),index,parseFloat(items[2])]);
          }
        }
        
      }
    });
    console.log(series);
  $('#container').highcharts({

    chart: {
      type: 'heatmap'
    },

    colorAxis: {
      stops: [
          [0, '#3060cf'],
          [0.5, '#fffbbc'],
          [0.9, '#c4463a'],
          [1, '#c4463a']
      ],
      endOnTick: false,
      startOnTick: false
    },
    
    legend: {
          align: 'right',
          layout: 'vertical',
          margin: 0,
          verticalAlign: 'top',
          y: 25,
          symbolHeight: 280
      },

    title: {
      text: 'Monthly Precipitation-Streamflow'
    },

    tooltip: {
      formatter: function()
      {
        return '<b>' + this.series.xAxis.categories[this.point.x] + ' ' + this.series.yAxis.categories[this.point.y] + '</b><br>' + this.point.value + 'inches';
      }
    },

    yAxis: {
      categories: years
    },

    xAxis: {
      categories: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sept','Oct','Nov','Dec'],
     },
    series: [series]

  });
});
</script>

</body>
</html>